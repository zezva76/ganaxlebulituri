




const translations = {
  en: {
    navHome: "Home",
    navGeorgia: "Georgia",
    navGallery: "Gallery",
    navPackage: "Package",
    navServices: "Services",
    navVoice: "Voice",
    navReview: "Review",
    navFooter: "Footer",

     homeTitle: "adventure is worthwhite",
    homeSubtitle: "Discover new places with us",
    homeSlogan: "travel to Imereti",
    showDiscoverBtn: "discover imereti",
    imeretiDescription: `
      <label class="info-imer-1">Imereti</label> — one of the historical and geographical regions of Western Georgia, currently part of the Imereti region. In a broad sense, it is the historical name of Western Georgia, as well as ancient Colchis, Egrisi, Abkhazia.

                    Imereti itself is bordered by the Black Sea to the east, Tskhenistskali to the west, the Caucasus Range to the north, and the Persati, or Meskheti, mountains to the south. The name is associated with the location of this region, Imereti, or the Likhsiki region.
                    
                    Imereti is divided into two parts: Lower and Upper Imereti. Archaeological monuments discovered on the territory of Imereti confirm that people began to live in this region as early as the Lower Paleolithic era. Among them are the Sakazii Cave and the Chakhati (on the banks of the Tskaltsitela River), Deviskhvreli (on the banks of the Chkherimela River) caves, the Sataplia area, and others. Archaeological monuments from the ancient period of urban life have been found in Kutaisi, Vani, Vartsikhe (Rhodopolis), Shorapani, and others. Due to the favorable geographical location of the region, these cities have had great strategic, economic, and political importance since ancient times

    `,
     loginTitle: "Login",
    emailPlaceholder: "Enter your email",
    passwordPlaceholder: "Enter your password",
    loginBtn: "Login now",
    rememberMe: "Remember me",
    forgetPassword: "Forget password?",
    clickHere: "Click here",
    noAccount: "Do not have an account?",
    registerNow: "Register now",

    
     imereti_name: "Imereti",
      afkhazeti_name: "Abkhazia",
       achara_name: "Adjara",
        guria_name: "Guria",
     kakheti_name: "Kakheti",
     kvemo_kartli_name: "Qvemo kartli",
     mtsketa_mtianeti_name: "Mtskheta mtianeti",
     racha_lechkhumi_name: "Racha lechkhumi",
     samtskhe_djavakheti_name: "Samtskhe djavakheti",
     samachablo_name: "Samachablo",
     shida_kartli_name: "Shida Qartli",
     samegrelo_zemosvaneti_name: "Samegrelo-Zeda svaneti",
    tbilisi_name: "Tbilisi",

     mwvane_xeoba: "Mtsvane Kheoba",
     browse_gallery: "Browse the gallery",
       see_more: "See more",
       promete_cave: "Promete cave",
       tetra_name: "Tetra cave",
       sataplia_name: "Sataplia",
       katskhi_name: "Katskhi sveti",
       martvili_name: "Martvili canion",
       read_more: "Read more",

       title_info: " Prometheus Cave formed in Sataphlia-Tskaltubo karst massif. The total length of the cave is about 11 km, of which 1800 m are open to visitors. The cave has a total of 22 halls, six of which are currently open to tourists. Visitors currently could experience these caves at depths of about 80 mts below ground level.",
 
        hotel_title:"Affordable hotels",
        food_title: "Food and Drink",
        contact_title: "Contact us",

        voice_title: "If you enjoy the Georgian wines and dishes, give like",
        chans_name: "Georgian wines",
        vans_name: "Georgian dishes",
        voice_name: "Like it",
        
          revie_title: "Leave a comment and photo",
        PlaceHolder: "Your name",
       opinionPlaceHolder: "Your oponion",
          sub_name: "Add"

  },



  ka: {
    navHome: "მთავარი",
    navGeorgia: "საქართველო",
    navGallery: "გალერეა",
    navPackage: "პაკეტები",
    navServices: "სერვისები",
    navVoice: "ხმები",
    navReview: "მიმოხილვა",
    navFooter: "კონტაქტი",

     homeTitle: "მოგზაურობა ღირსეულია",
    homeSubtitle: "აღმოაჩინე ახალი ადგილები ჩვენთან ერთად",
    homeSlogan: "იმოგზაურე იმერეთში",
    showDiscoverBtn: "აღმოაჩინე იმერეთი",
    imeretiDescription: `
      <label class="info-imer-1">იმერეთი</label>— დასავლეთ საქართველოს ერთ-ერთი ისტორიულ-გეოგრაფიული რეგიონი, ამჟამად იმერეთის რეგიონის ნაწილი. ფართო გაგებით, ეს არის დასავლეთ საქართველოს ისტორიული სახელწოდება, ასევე უძველესი კოლხეთი, ეგრისი, აფხაზეთი.

თავად იმერეთს აღმოსავლეთით ესაზღვრება შავი ზღვა, დასავლეთით ცხენისწყალი, ჩრდილოეთით კავკასიონის ქედი და სამხრეთით ფერსათის, ანუ მესხეთის მთები. სახელი დაკავშირებულია ამ რეგიონის მდებარეობასთან, იმერეთთან, ანუ ლიხსიკის რეგიონთან.

იმერეთი ორ ნაწილად იყოფა: ქვემო და ზემო იმერეთად. იმერეთის ტერიტორიაზე აღმოჩენილი არქეოლოგიური ძეგლები ადასტურებს, რომ ამ რეგიონში ადამიანები ჯერ კიდევ ქვედა პალეოლითის ხანაში დასახლდნენ. მათ შორისაა საკაზის გამოქვაბული და ჭახატი (მდინარე წყალწითელას ნაპირებზე), დევისხვრელის (მდინარე ჩხერიმელას ნაპირებზე) გამოქვაბულები, სათაფლიის ტერიტორია და სხვა. ქალაქური ცხოვრების უძველესი პერიოდის არქეოლოგიური ძეგლები აღმოჩენილია ქუთაისში, ვანში, ვარციხეში (როდოპოლისი), შორაპანში და სხვა. რეგიონის ხელსაყრელი გეოგრაფიული მდებარეობის გამო, ამ ქალაქებს უძველესი დროიდან დიდი სტრატეგიული, ეკონომიკური და პოლიტიკური მნიშვნელობა ჰქონდათ.
    `,

  loginTitle: "შესვლა",
    emailPlaceholder: "შეიყვანეთ ელ.ფოსტა",
    passwordPlaceholder: "შეიყვანეთ პაროლი",
    loginBtn: "შესვლა",
    rememberMe: "დამიმახსოვრე",
    forgetPassword: "დაგავიწყდა პაროლი?",
    clickHere: "დააჭირეთ აქ",
    noAccount: "არ გაქვთ ანგარიში?",
    registerNow: "რეგისტრაცია",

   

    imereti_name: "იმერეთი",
     afkhazeti_name: "აფხაზეთი",
     achara_name: "აჭარა",
      guria_name: "გურია",
     imereti_name: "იმერეთი",
     kakheti_name: "კახეთი",
     kvemo_kartli_name: "ქვემო ქართლი",
     mtsketa_mtianeti_name: "მცხეტა მთიანეთი",
     racha_lechkhumi_name: "რაჭა ლეჩხუმი",
     samtskhe_djavakheti_name: "სამცხე ჯავახეთი",
     samachablo_name: "სამაჩაბლო",
     shida_kartli_name: "შიდა ქართლი",
     samegrelo_zemosvaneti_name: "სამეგრელო-ზემო სვანეთი",
    tbilisi_name: "თბილისი",

   gallery_title: "გალერია",
    mwvane_xeoba: "მწვანე ხეობა",
     promete_cave: "პრომეთეს მღვიმე",
      tetra_name: "თეთრა მღვიმე",
       sataplia_name: "სათაფლია",
       katskhi_name: "კაცხის სვეტი",
       martvili_name: "მარტვილის კანიონი", 
       browse_gallery: "დაათვალიერეთ გალერეა",
        see_more: "ნახეთ მეტი",
       read_more: "გაიგეთ მეტი",

       title_info: "პრომეთეს მღვიმე სათაფლია-წყალტუბოს კარსტულ მასივში ჩამოყალიბდა. მღვიმის საერთო სიგრძე დაახლოებით 11 კმ-ია, საიდანაც 1800 მ ღიაა ვიზიტორებისთვის. მღვიმეს სულ 22 დარბაზი აქვს, რომელთაგან ექვსი ამჟამად ტურისტებისთვის ღიაა. ვიზიტორებს ამჟამად ამ მღვიმეების დათვალიერება მიწის დონიდან დაახლოებით 80 მეტრის სიღრმეზე შეუძლიათ.",
        
       hotel_title:"ხელმისაწვდომი სასტუმროები",
        food_title: "საკვები და სასმელები",
        contact_title: "დაგვიკავშირდით",

        voice_title: "თუ მოგწონთ ქართული ღვინოები და კერძები, მოიწონეთ",
          chans_name: "ქართული ღვინო",
        vans_name: "ქართული კერძები",
        voice_name: "მოიწონე",

         revie_title: "დატოვეთ კომენტარი და ფოტო",
        PlaceHolder: "თქვენი სახელი",
        opinionPlaceHolder: "თქვენი აზრი",
          sub_name: "დამატება",
  },

  

};

function setLanguage(lang) {
  localStorage.setItem('lang', lang);

  // textContent-ების განახლება
  document.querySelectorAll('[data-translate]').forEach(el => {
    const key = el.getAttribute('data-translate');
    if (translations[lang][key]) {
      el.textContent = translations[lang][key];
    }
  });

  // placeholder-ის განახლება
  document.querySelectorAll('[data-translate-placeholder]').forEach(el => {
    const key = el.getAttribute('data-translate-placeholder');
    if (translations[lang][key]) {
      el.setAttribute('placeholder', translations[lang][key]);
    }
  });

  // input value-ს განახლება (submit button)
  document.querySelectorAll('[data-translate-value]').forEach(el => {
    const key = el.getAttribute('data-translate-value');
    if (translations[lang][key]) {
      el.setAttribute('value', translations[lang][key]);
    }
  });

  // დიდ ტექსტს ინახავ
  const imeretiTextEl = document.getElementById('imereti-description');
  if (imeretiTextEl && translations[lang].imeretiDescription) {
    imeretiTextEl.innerHTML = translations[lang].imeretiDescription;
  }

  // active კლასის გადართვა ენის ღილაკებზე
  document.querySelectorAll('.language-switcher button').forEach(btn => {
    btn.classList.toggle('active', btn.getAttribute('data-lang') === lang);
  });
}










document.addEventListener('DOMContentLoaded', () => {

  const searchBtn = document.querySelector('#search-btn');
  const searchBar = document.querySelector('.search-bar-container');
  const formBtn = document.querySelector('#login-btn');
  const loginForm = document.querySelector('.login-form-container');
  const formClose = document.querySelector('#form-close');
  const menu = document.querySelector('#menu-bar');
  const navbar = document.querySelector('.navbar');
  const showButtonDiscover = document.getElementById('show-info-button-discover');
  const photoInfoDiscover = document.getElementById('info-discover');
  const closeButtonDiscover = document.getElementById('close-button-discover');

  window.addEventListener('scroll', () => {
    searchBtn?.classList.remove('fa-times');
    searchBar?.classList.remove('active');
    menu?.classList.remove('fa-times');
    navbar?.classList.remove('active');
    loginForm?.classList.remove('active');
  });

  menu?.addEventListener('click', () => {
    menu.classList.toggle('fa-times');
    navbar.classList.toggle('active');
  });

  searchBtn?.addEventListener('click', () => {
    searchBtn.classList.toggle('fa-times');
    searchBar.classList.toggle('active');
  });

  formBtn?.addEventListener('click', () => {
    loginForm.classList.add('active');
  });

  formClose?.addEventListener('click', () => {
    loginForm.classList.remove('active');
  });

  if (showButtonDiscover && photoInfoDiscover && closeButtonDiscover) {
    showButtonDiscover.addEventListener('click', () => {
      photoInfoDiscover.style.display = 'flex';
      showButtonDiscover.style.display = 'none';
    });

    closeButtonDiscover.addEventListener('click', () => {
      photoInfoDiscover.style.display = 'none';
      showButtonDiscover.style.display = 'inline-block';
    });
  }

  new Swiper(".review-slider", {
    spaceBetween: 20,
    loop: true,
    autoplay: {
      delay: 2500,
      disableOnInteraction: false,
    },
    breakpoints: {
      640: { slidesPerView: 1 },
      768: { slidesPerView: 2 },
      1024: { slidesPerView: 3 },
    },
  });

});



//ლოგინი logi in

const loginForm = document.getElementById('loginForm');

if (loginForm) {
  loginForm.addEventListener('submit', async function (e) {
    e.preventDefault();

    const email = loginForm.email.value;
    const password = loginForm.password.value;

    const response = await fetch('http://localhost:3000/login', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ email, password })
    });

    const result = await response.json();

    if (response.ok) {
      alert('შესვლა წარმატებულია!');
      console.log('მონაცემები:', result);
    } else {
      alert(result.message || 'შეცდომა ავტორიზაციაში');
    }
  });
}





function showName(key, foto) {
  const lang = localStorage.getItem('lang') || 'en';
  const nameDisplay = document.getElementById('nameDisplay');
  const fotoDisplay = document.getElementById('photoDisplay');
  const infoDisplay = document.getElementById('infoDisplay');

  if (nameDisplay && fotoDisplay && infoDisplay) {
    // translations ობიექტიდან ენაზე მიხედვით ვიღებთ სახელს
    const translatedName = translations[lang] && translations[lang][key] ? translations[lang][key] : key;

    nameDisplay.textContent = translatedName;
    nameDisplay.setAttribute('data-translate', key); // რომ setLanguage-ში იმუშაოს
    fotoDisplay.src = foto;
    infoDisplay.style.display = 'block';
  }
}







// PACKAGE SECTION JS OPTIMIZED
// 1. "read more" ღილაკების მართვა
const showButtons = document.querySelectorAll('.show-info-button-class'); // აირჩიეთ ყველა ღილაკი ამ კლასით

showButtons.forEach(button => {
    button.addEventListener('click', () => {
        // იპოვეთ შესაბამისი "photo-info-modal-class" კონტეინერი
        const box = button.closest('.box');
        const photoInfoModal = box.querySelector('.photo-info-modal-class');

        if (photoInfoModal) {
            photoInfoModal.style.display = 'flex'; // გამოაჩინეთ მოდალი
            button.style.display = 'none'; // დამალეთ "read more" ღილაკი
        }
    });
});

// 2. "close" ღილაკების მართვა
const closeButtons = document.querySelectorAll('.close-button-class'); // აირჩიეთ ყველა close ღილაკი

closeButtons.forEach(button => {
    button.addEventListener('click', () => {
        // იპოვეთ შესაბამისი "photo-info-modal-class" კონტეინერი
        const photoInfoModal = button.closest('.photo-info-modal-class');
        // იპოვეთ შესაბამისი "read more" ღილაკი
        const box = button.closest('.box');
        const showButton = box.querySelector('.show-info-button-class');

        if (photoInfoModal) {
            photoInfoModal.style.display = 'none'; // დამალეთ მოდალი
        }
        if (showButton) {
            showButton.style.display = 'block'; // გამოაჩინეთ "read more" ღილაკი
        }
    });
});





// ღილაკი "read more" — მხოლოდ ტექსტის ჩვენება
document.querySelectorAll('.show-info-button-class').forEach(button => {
  button.addEventListener('click', function () {
    const box = this.closest('.box');
    const modal = box.querySelector('.photo-info-modal-class');
    const map = modal.querySelector('.modal-map-content');
    const text = modal.querySelector('.modal-text-content');

    modal.style.display = 'flex';
    text.style.display = 'block';  // ტექსტი ჩართულია
    map.style.display = 'none';    // რუკა დამალულია
  });
});






// იკონაზე დაჭერა — მხოლოდ რუკის ჩვენება
document.querySelectorAll('.show-map-button-class').forEach(icon => {
  icon.addEventListener('click', function (e) {
    e.preventDefault();

    const box = this.closest('.box');
    const modal = box.querySelector('.photo-info-modal-class');
    const map = modal.querySelector('.modal-map-content');
    const text = modal.querySelector('.modal-text-content');

    modal.style.display = 'flex';
    map.style.display = 'block';   // რუკა ჩართულია
    text.style.display = 'none';   // ტექსტი დამალულია
  });
});

// დახურვის ღილაკი
document.querySelectorAll('.close-button-class').forEach(button => {
  button.addEventListener('click', function () {
    const modal = this.closest('.photo-info-modal-class');
    modal.style.display = 'none';
  });
});




//review

// აქ ჩაწერე შენი Railway სერვერის Public URL (არა localhost)
const API_BASE_URL = "https://steadfast-liberation.up.railway.app"; // შეცვალე შენს URL-ით

const form = document.getElementById("commentForm");
const wrapper = document.getElementById("reviewWrapper");

// სლაიდერის ობიექტი (Swiper)
let swiper;

// კომენტარის DOM-ში დამატება
function renderReview(review) {
  const div = document.createElement("div");
  div.className = "swiper-slide";
  div.innerHTML = `
    <div class="box">
      ${review.photo ? `<img src="${review.photo}" alt="User Photo" width="200" />` : ""}
      <h3>${review.name}</h3>
      <p>${review.text}</p>
      <div class="stars">
        <i class="fas fa-star"></i>
        <i class="fas fa-star"></i>
        <i class="fas fa-star"></i>
        <i class="fas fa-star-half-alt"></i>
        <i class="far fa-star"></i>
      </div>
    </div>
  `;
  wrapper.appendChild(div);
}

// კომენტარების ჩატვირთვა სერვერიდან
async function loadReviews() {
  wrapper.innerHTML = "";
  try {
    const res = await fetch(`${API_BASE_URL}/api/comments`);
    if (!res.ok) throw new Error("Failed to fetch comments");

    const reviews = await res.json();

    reviews.forEach(renderReview);

    if (!swiper) {
      swiper = new Swiper(".review-slider", {
        spaceBetween: 20,
        loop: true,
        autoplay: { delay: 2500, disableOnInteraction: false },
        pagination: { el: ".swiper-pagination", clickable: true },
        navigation: { nextEl: ".swiper-button-next", prevEl: ".swiper-button-prev" },
        breakpoints: {
          0: { slidesPerView: 1 },
          768: { slidesPerView: 2 },
          991: { slidesPerView: 3 },
        },
      });
    } else {
      swiper.update();
    }
  } catch (error) {
    console.error("Failed to load reviews:", error);
  }
}

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  const formData = new FormData(form);

  console.log("Sending formData:", [...formData.entries()]); // აქ ვნახავ, რა მიდის ფრონტენდიდან

  try {
    const res = await fetch(`${API_BASE_URL}/api/comments`, {
      method: "POST",
      body: formData,
    });

    const data = await res.json();

    console.log("Response from server:", data);

    if (!res.ok) {
      alert(data.message || "Error submitting comment");
      return;
    }

    alert("Comment added successfully!");
    form.reset();
    loadReviews();
  } catch (error) {
    alert("Failed to send comment.");
    console.error(error);
  }
});

// გვერდის ჩატვირთვისას დაიძახე დატვირთვა
loadReviews();
